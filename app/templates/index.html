{% extends 'base.html' %}
{% block content %}
<section class="card">
  <h2>New Query</h2>
  <form method="post" action="{{ url_for('run_query') }}" class="query-form">
    <input type="text" name="query" placeholder="e.g., Latest research on AI in education" required />
    <button type="submit">Generate Report</button>
  </form>
  <p class="hint">The agent will search (Tavily), extract (Trafilatura/PyPDF), summarize (OpenAI), and save.</p>
</section>

<section class="card">
  <h2>Saved Reports</h2>
  {% if reports %}
    <table class="reports">
      <thead>
        <tr><th>Created</th><th>Query</th><th>Open</th></tr>
      </thead>
      <tbody>
      {% for r in reports %}
        <tr>
          <td>{{ r.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
          <td>{{ r.query }}</td>
          <td><a class="btn" href="{{ url_for('view_report', report_id=r.id) }}">View</a></td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No reports yet. Try a query above.</p>
  {% endif %}
</section>
{% endblock %}
